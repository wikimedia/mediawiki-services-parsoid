{
    "<ref> defined in <references> called with #tag": {
        "wt2html": "<p data-parsoid='{\"dsr\":[0,18,0,0]}'><sup about=\"#mwt2\" class=\"mw-ref reference\" id=\"cite_ref-foo_1-0\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"dsr\":[0,18,18,0]}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"foo\"}}'><a href=\"./Parser_test#cite_note-foo-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup></p>\n\n<p data-parsoid='{\"dsr\":[20,67,0,0]}'><references about=\"#mwt4\" typeof=\"mw:Transclusion\" data-parsoid='{\"dsr\":[20,67,null,null],\"pi\":[[{\"k\":\"1\"}]]}' data-mw='{\"parts\":[{\"template\":{\"target\":{\"wt\":\"#tag:references\",\"function\":\"tag\"},\"params\":{\"1\":{\"wt\":\"\\n&lt;ref name=\\\"foo\\\">BAR&lt;/ref>\\n\"}},\"i\":0}}]}'>\n<sup about=\"#mwt5\" class=\"mw-ref reference\" id=\"cite_ref-foo_1-1\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"src\":\"&lt;ref name=\\\"foo\\\">BAR&lt;/ref>\"}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"foo\"},\"body\":{\"id\":\"mw-reference-text-cite_note-foo-1\"}}'><a href=\"./Parser_test#cite_note-foo-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup>\n</references></p>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt6\" data-parsoid='{\"dsr\":[67,67,0,0]}' data-mw='{\"name\":\"references\",\"attrs\":{},\"autoGenerated\":true}'><ol class=\"mw-references references\" data-parsoid=\"{}\"><li about=\"#cite_note-foo-1\" id=\"cite_note-foo-1\" data-parsoid=\"{}\"><span rel=\"mw:referencedBy\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-foo_1-0\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">1 </span></a><a href=\"./Parser_test#cite_ref-foo_1-1\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">2 </span></a></span> <span id=\"mw-reference-text-cite_note-foo-1\" class=\"mw-reference-text\" data-parsoid=\"{}\">BAR</span></li></ol></div>",
        "wt2wt": "<ref name=\"foo\" />\n\n{{#tag:references|\n<ref name=\"foo\">BAR</ref>\n}}\n<references />",
        "html2html": "<p data-parsoid='{\"dsr\":[0,18,0,0]}'><sup about=\"#mwt3\" class=\"mw-ref reference\" id=\"cite_ref-foo_1-0\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"dsr\":[0,18,18,0]}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"foo\"}}'><a href=\"./Parser_test#cite_note-foo-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup></p>\n\n<p data-parsoid='{\"dsr\":[20,67,0,0]}'><references about=\"#mwt5\" typeof=\"mw:Transclusion\" data-parsoid='{\"dsr\":[20,67,null,null],\"pi\":[[{\"k\":\"1\"}]]}' data-mw='{\"parts\":[{\"template\":{\"target\":{\"wt\":\"#tag:references\",\"function\":\"tag\"},\"params\":{\"1\":{\"wt\":\"\\n&lt;ref name=\\\"foo\\\">BAR&lt;/ref>\\n\"}},\"i\":0}}]}'>\n<sup about=\"#mwt6\" class=\"mw-ref reference\" id=\"cite_ref-foo_1-1\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"src\":\"&lt;ref name=\\\"foo\\\">BAR&lt;/ref>\"}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"foo\"},\"body\":{\"id\":\"mw-reference-text-cite_note-foo-1\"}}'><a href=\"./Parser_test#cite_note-foo-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup>\n</references></p>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt7\" data-parsoid='{\"dsr\":[67,67,0,0]}' data-mw='{\"name\":\"references\",\"attrs\":{},\"autoGenerated\":true}'><ol class=\"mw-references references\" data-parsoid=\"{}\"><li about=\"#cite_note-foo-1\" id=\"cite_note-foo-1\" data-parsoid=\"{}\"><span rel=\"mw:referencedBy\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-foo_1-0\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">1 </span></a><a href=\"./Parser_test#cite_ref-foo_1-1\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">2 </span></a></span> <span id=\"mw-reference-text-cite_note-foo-1\" class=\"mw-reference-text\" data-parsoid=\"{}\">BAR</span></li></ol></div>",
        "selser [0,0,0,4,0]": "<ref name=\"foo\" />\n\n{{#tag:references|\n<ref name=\"foo\">BAR</ref>\n}}\n\n1h4si2i",
        "selser [1,3,0,3,0]": "<ref name=\"foo\" />\n\n{{#tag:references|\n<ref name=\"foo\">BAR</ref>\n}}",
        "selser [0,4,3,0,0]": "<ref name=\"foo\" />\n\n12vvoew\n",
        "selser [0,3,4,0,0]": "<ref name=\"foo\" />\n\n167l5c9\n",
        "selser [3,4,0,0,0]": "9164cv\n\n{{#tag:references|\n<ref name=\"foo\">BAR</ref>\n}}",
        "selser [1,0,4,0,0]": "<ref name=\"foo\" />\n\ncecap3\n",
        "selser [2,0,1,4,0]": "11031sy\n\n<ref name=\"foo\" />\n\n{{#tag:references|\n<ref name=\"foo\">BAR</ref>\n}}\n\nugd1r0",
        "selser [0,4,0,0,0]": "<ref name=\"foo\" />\n\nsm4tm\n\n{{#tag:references|\n<ref name=\"foo\">BAR</ref>\n}}",
        "selser [1,2,0,0,0]": "<ref name=\"foo\" />\n\nv6hvl3\n\n{{#tag:references|\n<ref name=\"foo\">BAR</ref>\n}}",
        "selser [4,2,0,0,0]": "2if78t\n\n54patw\n\n{{#tag:references|\n<ref name=\"foo\">BAR</ref>\n}}",
        "selser [4,0,3,3,0]": "ncj63m\n\n",
        "selser [4,2,3,4,0]": "1do4lk2\n\nwzvw8b\n\n52ply3",
        "selser [0,3,3,3,0]": "<ref name=\"foo\" />",
        "selser [3,2,0,0,0]": "1gurfwg\n\n{{#tag:references|\n<ref name=\"foo\">BAR</ref>\n}}",
        "selser [0,3,0,3,0]": "<ref name=\"foo\" />\n\n{{#tag:references|\n<ref name=\"foo\">BAR</ref>\n}}",
        "selser [4,0,1,4,0]": "1qcd0j4\n\n{{#tag:references|\n<ref name=\"foo\">BAR</ref>\n}}\n\n7kvuk1",
        "selser [0,0,0,3,0]": "<ref name=\"foo\" />\n\n{{#tag:references|\n<ref name=\"foo\">BAR</ref>\n}}",
        "selser [0,0,0,2,0]": "<ref name=\"foo\" />\n\n{{#tag:references|\n<ref name=\"foo\">BAR</ref>\n}}\n\nd6424z\n",
        "selser [2,0,1,0,0]": "15tsmjq\n\n<ref name=\"foo\" />\n\n{{#tag:references|\n<ref name=\"foo\">BAR</ref>\n}}\n",
        "selser [2,3,3,0,0]": "1tof2ch\n\n<ref name=\"foo\" />\n"
    },
    "<ref> in a link should hoist the link outside the link (T301293)": {
        "selser [[1,0],4,0]": "[[Foo|''x<ref>y</ref>z'']]\n\n1m2lppn",
        "selser [2,4,0]": "ld2a56\n\n[[Foo|''x<ref>y</ref>z'']]\n\n6h9131",
        "selser [[2,0],3,0]": "nc8qrb[[Foo|''x<ref>y</ref>z'']]",
        "selser [[[2],0],2,0]": "[[Foo|10bqz6j''x<ref>y</ref>z'']]\n\n10lq6vy\n",
        "selser [2,3,0]": "588i32\n\n[[Foo|''x<ref>y</ref>z'']]",
        "selser [2,0,0]": "166nxt2\n\n[[Foo|''x<ref>y</ref>z'']]",
        "selser [4,0,0]": "1bxnu7o\n",
        "selser [1,0,0]": "[[Foo|''x<ref>y</ref>z'']]\n",
        "selser [3,3,0]": "",
        "selser [3,4,0]": "jwpc9a",
        "selser [[1,0],3,0]": "[[Foo|''x<ref>y</ref>z'']]",
        "selser [1,4,0]": "[[Foo|''x<ref>y</ref>z'']]\n\ne6nlfi",
        "selser [3,0,0]": "\n",
        "selser [[3,0],4,0]": "\n\nb7dsqp",
        "selser [4,2,0]": "zygsjj\n\ncij924\n",
        "selser [2,2,0]": "1ddbvcj\n\n[[Foo|''x<ref>y</ref>z'']]\n\nx6skl7\n",
        "selser [[[2],0],0,0]": "[[Foo|1yvz53o''x<ref>y</ref>z'']]\n",
        "selser [[[[2]],0],0,0]": "[[Foo|''138os21xz'']]\n",
        "selser [1,2,0]": "[[Foo|''x<ref>y</ref>z'']]\n\n13m61ka\n",
        "selser [[1,0],0,0]": "[[Foo|''x<ref>y</ref>z'']]\n"
    },
    "Blank ref followed by ref with content": {
        "selser [0,4,1,3,0]": "<ref name=\"blank\" />\n\n14bnq08\n\n<ref name=\"blank\">content</ref>\n\n<references />"
    },
    "Bug 13073 regression check: wrapped <references>": {
        "html2wt": "<ref>\nfoo\n</ref>\n<div>\n<references />\n</div>",
        "selser [0,3,3]": "<ref>\nfoo\n</ref>",
        "selser [1,0,3]": "<ref>\nfoo\n</ref>\n",
        "selser [2,0,3]": "1n3of6i\n\n<ref>\nfoo\n</ref>\n",
        "selser [0,0,4]": "<ref>\nfoo\n</ref>\n\n193v7o9"
    },
    "Bug 31374 regression check: nested strip items": {
        "wt2html": "<p data-parsoid='{\"dsr\":[0,48,0,0]}'><ref about=\"#mwt2\" typeof=\"mw:Transclusion\" data-parsoid='{\"a\":{\"group\":null},\"sa\":{\"group\":\"Note\"},\"dsr\":[0,48,null,null],\"pi\":[[{\"k\":\"1\"},{\"k\":\"group\",\"named\":true}]]}' data-mw='{\"parts\":[{\"template\":{\"target\":{\"wt\":\"#tag:ref\",\"function\":\"tag\"},\"params\":{\"1\":{\"wt\":\"note&lt;ref>reference&lt;/ref>\"},\"group\":{\"wt\":\"Note\"}},\"i\":0}}]}'>note<sup about=\"#mwt3\" class=\"mw-ref reference\" id=\"cite_ref-1\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"src\":\"&lt;ref>reference&lt;/ref>\"}' data-mw='{\"name\":\"ref\",\"attrs\":{},\"body\":{\"id\":\"mw-reference-text-cite_note-1\"}}'><a href=\"./Parser_test#cite_note-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup></ref></p>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt5\" data-parsoid='{\"group\":\"Note\",\"dsr\":[49,76,27,0]}' data-mw='{\"name\":\"references\",\"attrs\":{\"group\":\"Note\"}}'><ol class=\"mw-references references\" data-mw-group=\"Note\" data-parsoid=\"{}\"></ol></div>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt7\" data-parsoid='{\"dsr\":[77,91,14,0]}' data-mw='{\"name\":\"references\",\"attrs\":{}}'><ol class=\"mw-references references\" data-parsoid=\"{}\"><li about=\"#cite_note-1\" id=\"cite_note-1\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-1\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-1\" class=\"mw-reference-text\" data-parsoid=\"{}\">reference</span></li></ol></div>",
        "html2html": "<p data-parsoid='{\"dsr\":[0,48,0,0]}'><ref about=\"#mwt3\" typeof=\"mw:Transclusion\" data-parsoid='{\"a\":{\"group\":null},\"sa\":{\"group\":\"Note\"},\"dsr\":[0,48,null,null],\"pi\":[[{\"k\":\"1\"},{\"k\":\"group\",\"named\":true}]]}' data-mw='{\"parts\":[{\"template\":{\"target\":{\"wt\":\"#tag:ref\",\"function\":\"tag\"},\"params\":{\"1\":{\"wt\":\"note&lt;ref>reference&lt;/ref>\"},\"group\":{\"wt\":\"Note\"}},\"i\":0}}]}'>note<sup about=\"#mwt4\" class=\"mw-ref reference\" id=\"cite_ref-1\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"src\":\"&lt;ref>reference&lt;/ref>\"}' data-mw='{\"name\":\"ref\",\"attrs\":{},\"body\":{\"id\":\"mw-reference-text-cite_note-1\"}}'><a href=\"./Parser_test#cite_note-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup></ref></p>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt6\" data-parsoid='{\"group\":\"Note\",\"dsr\":[49,76,27,0]}' data-mw='{\"name\":\"references\",\"attrs\":{\"group\":\"Note\"}}'><ol class=\"mw-references references\" data-mw-group=\"Note\" data-parsoid=\"{}\"></ol></div>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt8\" data-parsoid='{\"dsr\":[77,91,14,0]}' data-mw='{\"name\":\"references\",\"attrs\":{}}'><ol class=\"mw-references references\" data-parsoid=\"{}\"><li about=\"#cite_note-1\" id=\"cite_note-1\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-1\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-1\" class=\"mw-reference-text\" data-parsoid=\"{}\">reference</span></li></ol></div>"
    },
    "Check Cite handing of linefeed whitespace in reference names": {
        "wt2wt": "test linefeed<ref name=\"a b\">testLinefeedRef</ref>\n<references />",
        "html2wt": "test linefeed<ref name=\"a b\">testLinefeedRef</ref>\n<references />",
        "selser [[4,0],0,0]": "1euwgyt<ref name=\"a\nb\">testLinefeedRef</ref>\n<references />",
        "selser [1,3,0]": "test linefeed<ref name=\"a\nb\">testLinefeedRef</ref><references />",
        "selser [2,0,0]": "15lkr1g\n\ntest linefeed<ref name=\"a\nb\">testLinefeedRef</ref>\n<references />",
        "selser [1,4,0]": "test linefeed<ref name=\"a\nb\">testLinefeedRef</ref>\n\n1hw2qoa<references />",
        "selser [0,4,0]": "test linefeed<ref name=\"a\nb\">testLinefeedRef</ref>\n\nfint7y<references />",
        "selser [[3,0],2,0]": "<ref name=\"a\nb\">testLinefeedRef</ref>\n\n1881x1z\n<references />",
        "selser [[3,0],0,0]": "<ref name=\"a\nb\">testLinefeedRef</ref>\n<references />",
        "selser [1,0,0]": "test linefeed<ref name=\"a\nb\">testLinefeedRef</ref>\n<references />",
        "selser [0,3,0]": "test linefeed<ref name=\"a\nb\">testLinefeedRef</ref><references />",
        "selser [1,2,0]": "test linefeed<ref name=\"a\nb\">testLinefeedRef</ref>\n\n13030ir\n<references />",
        "selser [2,3,0]": "w46ct0\n\ntest linefeed<ref name=\"a\nb\">testLinefeedRef</ref><references />",
        "selser [[2,0],2,0]": "piffj2test linefeed<ref name=\"a\nb\">testLinefeedRef</ref>\n\n2rj5xm\n<references />",
        "selser [[2,0],0,0]": "pwq7btest linefeed<ref name=\"a\nb\">testLinefeedRef</ref>\n<references />",
        "selser [[2,0],3,0]": "i6npostest linefeed<ref name=\"a\nb\">testLinefeedRef</ref><references />"
    },
    "Counters should be cleared after processing named <references group=\"…\">": {
        "selser [2,0,0,4,[4,0],3,0]": "1m78266\n\nA <ref group=\"g\">foo</ref>\n\n<references group=\"g\" />g92zhb\n\n1sqtkvt<ref group=\"g\">bar</ref>\n\n<references group=\"g\" />"
    },
    "Erroneous refs": {
        "wt2wt": "<ref name=\"0\">Zero</ref>\n\n<ref>Also zero, but differently! (Normal ref)</ref>\n\n<ref />\n\n<ref name=\"bar\" />\n\n<ref name=\"blankwithnoreference\" />\n\n<references name=\"quasit\" />\n\n<references />",
        "html2wt": "<ref name=\"0\">Zero</ref>\n\n<ref>Also zero, but differently! (Normal ref)</ref>\n\n<ref />\n\n<ref name=\"bar\" />\n\n<ref name=\"blankwithnoreference\" />\n\n<references name=\"quasit\" />\n\n<references />",
        "selser [0,0,4,2,4,0,0,3,0,0,0,0,0]": "<ref name=\"0\">Zero</ref>\n\nwie687\n\n1u7xv04\n\n1pm36tv\n\n<ref name=\"foo\" name=\"bar\" />\n\n<ref name=\"blankwithnoreference\" />\n\n<references name=\"quasit\" />\n\n<references />",
        "selser [3,2,0,0,1,2,0,0,1,0,0,2,0]": "1tb8tca\n\n<ref>Also zero, but differently! (Normal ref)</ref>\n\n<ref />\n\nl49cv6\n\n<ref name=\"foo\" name=\"bar\" />\n\n<ref name=\"blankwithnoreference\" />\n\n<references name=\"quasit\" />ql4aqu\n\n<references />",
        "selser [0,3,0,0,0,2,0,0,1,0,0,3,0]": "<ref name=\"0\">Zero</ref>\n\n<ref>Also zero, but differently! (Normal ref)</ref>\n\n<ref />\n\n1if3p11\n\n<ref name=\"foo\" name=\"bar\" />\n\n<ref name=\"blankwithnoreference\" />\n\n<references name=\"quasit\" /><references />",
        "selser [2,0,4,3,4,4,0,0,0,3,0,0,0]": "1s759zl\n\n<ref name=\"0\">Zero</ref>\n\n1qgybr7\n\n1mfflfd\n\nruzy1u\n\n<ref name=\"foo\" name=\"bar\" />\n\n<ref name=\"blankwithnoreference\" /><references name=\"quasit\" />\n\n<references />",
        "selser [0,4,0,3,0,0,0,0,0,3,0,0,0]": "<ref name=\"0\">Zero</ref>\n\n1lc0182\n\n<ref>Also zero, but differently! (Normal ref)</ref>\n\n<ref />\n\n<ref name=\"foo\" name=\"bar\" />\n\n<ref name=\"blankwithnoreference\" /><references name=\"quasit\" />\n\n<references />",
        "selser [3,0,0,0,0,4,0,0,3,0,0,2,0]": "\n<ref>Also zero, but differently! (Normal ref)</ref>\n\n<ref />\n\nmg82zd\n\n<ref name=\"foo\" name=\"bar\" />\n\n<references name=\"quasit\" />xefmhr\n\n<references />",
        "selser [3,2,4,2,4,0,0,2,3,0,0,4,0]": "im3he0\n\njws5le\n\ngf9tte\n\nsqickf\n\n<ref name=\"foo\" name=\"bar\" />\n\n14jiq7o\n\n<references name=\"quasit\" />1i0xhb<references />",
        "selser [3,0,4,2,0,2,0,0,0,0,0,4,0]": "\n1to8jou\n\n1q4t40z\n\n<ref />\n\nh1kd4g\n\n<ref name=\"foo\" name=\"bar\" />\n\n<ref name=\"blankwithnoreference\" />\n\n<references name=\"quasit\" />2s6rnl<references />",
        "selser [0,0,1,0,0,4,0,3,1,2,0,4,0]": "<ref name=\"0\">Zero</ref>\n\n<ref>Also zero, but differently! (Normal ref)</ref>\n\n<ref />\n\nermh8y\n\n<ref name=\"foo\" name=\"bar\" />\n\n<ref name=\"blankwithnoreference\" />\n\n1lc73ob\n\n<references name=\"quasit\" />mzul4n<references />",
        "selser [1,0,0,3,1,3,1,0,2,0,0,4,0]": "<ref name=\"0\">Zero</ref>\n\n<ref>Also zero, but differently! (Normal ref)</ref>\n\n<ref />\n\n<ref name=\"foo\" name=\"bar\" />\n\ngmbpkw\n\n<ref name=\"blankwithnoreference\" />\n\n<references name=\"quasit\" />1xfh5g7<references />",
        "selser [2,0,3,2,0,0,2,3,4,0,0,0,0]": "mucbqr\n\n<ref name=\"0\">Zero</ref>\n\ni8peub\n\n<ref />\n\n1px26o6\n\n<ref name=\"foo\" name=\"bar\" />\n\n18pbxhl\n\n<references name=\"quasit\" />\n\n<references />",
        "selser [2,0,2,2,0,4,2,0,0,3,0,3,0]": "sqk5eb\n\n<ref name=\"0\">Zero</ref>\n\n4v5cn6\n\n<ref>Also zero, but differently! (Normal ref)</ref>\n\n1v6r6u9\n\n<ref />\n\n1nafanq\n\nc5qatn\n\n<ref name=\"foo\" name=\"bar\" />\n\n<ref name=\"blankwithnoreference\" /><references name=\"quasit\" /><references />",
        "selser [4,4,4,0,0,0,0,3,1,2,0,0,0]": "1devhdy\n\n1o3vfrh\n\n1hbzkdi\n\n<ref />\n\n<ref name=\"foo\" name=\"bar\" />\n\n<ref name=\"blankwithnoreference\" />\n\nqgk2ub\n\n<references name=\"quasit\" />\n\n<references />",
        "selser [0,0,2,0,2,2,2,4,0,0,0,2,0]": "<ref name=\"0\">Zero</ref>\n\n154g1s7\n\n<ref>Also zero, but differently! (Normal ref)</ref>\n\n1lzjdgw\n\n<ref />\n\nmycz92\n\n1phfm0r\n\n<ref name=\"foo\" name=\"bar\" />\n\n18223mm\n\n<ref name=\"blankwithnoreference\" />\n\n<references name=\"quasit\" />odszxr\n\n<references />",
        "selser [0,0,1,0,0,0,0,0,0,4,0,0,0]": "<ref name=\"0\">Zero</ref>\n\n<ref>Also zero, but differently! (Normal ref)</ref>\n\n<ref />\n\n<ref name=\"foo\" name=\"bar\" />\n\n<ref name=\"blankwithnoreference\" />\n\n1tejkzu<references name=\"quasit\" />\n\n<references />",
        "selser [0,0,0,3,0,2,2,3,1,0,0,2,0]": "<ref name=\"0\">Zero</ref>\n\n<ref>Also zero, but differently! (Normal ref)</ref>\n\n<ref />\n\narbfc9\n\n1nbyl9p\n\n<ref name=\"foo\" name=\"bar\" />\n\n<ref name=\"blankwithnoreference\" />\n\n<references name=\"quasit\" />19hld02\n\n<references />"
    },
    "Grouped references with automatic group references generating errors": {
        "selser [2,3,0,0,0,4,0]": "e7hpvx\n\nGROUP <ref group=\"theGroup\" name=\"theName\">theValue</ref>\nGROUP3 <ref group=\"theGroup3\" name=\"theName3\">theValue3</ref>\nGROUP2 <ref group=\"theGroup2\" name=\"theName2\">theValue2</ref>\naDifferentNameGROUP3 <ref group=\"theGroup3\" name=\"theName\">anotherValue3differentName</ref>\naDifferentNameGROUP2 <ref group=\"theGroup2\" name=\"anotherName2\">anotherValue2DifferentName</ref>\nanotherGROUP3 <ref group=\"theGroup3\" name=\"theName3\">anotherValue3</ref>\naDifferentNameGROUP <ref group=\"theGroup\" name=\"anotherName2\">anotherValueDifferentName</ref><references group=\"theGroup3\" />2qh34j",
        "selser [[3,0,0,0,0,0,4,0,2,0,4,0,2,0],0,0,0,0,4,0]": "<ref group=\"theGroup\" name=\"theName\">theValue</ref>\nGROUP3 <ref group=\"theGroup3\" name=\"theName3\">theValue3</ref>\nGROUP2 <ref group=\"theGroup2\" name=\"theName2\">theValue2</ref>1h4fq7t<ref group=\"theGroup3\" name=\"theName\">anotherValue3differentName</ref>z1cho3\naDifferentNameGROUP2 <ref group=\"theGroup2\" name=\"anotherName2\">anotherValue2DifferentName</ref>1n1fwoa<ref group=\"theGroup3\" name=\"theName3\">anotherValue3</ref>dy2vej\naDifferentNameGROUP <ref group=\"theGroup\" name=\"anotherName2\">anotherValueDifferentName</ref>\n<references group=\"theGroup3\" />1jop4wf",
        "selser [[2,0,0,0,3,0,0,0,2,0,4,0,0,0],0,0,0,0,2,0]": "1o90mvqGROUP <ref group=\"theGroup\" name=\"theName\">theValue</ref>\nGROUP3 <ref group=\"theGroup3\" name=\"theName3\">theValue3</ref><ref group=\"theGroup2\" name=\"theName2\">theValue2</ref>\naDifferentNameGROUP3 <ref group=\"theGroup3\" name=\"theName\">anotherValue3differentName</ref>rwewyu\naDifferentNameGROUP2 <ref group=\"theGroup2\" name=\"anotherName2\">anotherValue2DifferentName</ref>1c8jkqj<ref group=\"theGroup3\" name=\"theName3\">anotherValue3</ref>\naDifferentNameGROUP <ref group=\"theGroup\" name=\"anotherName2\">anotherValueDifferentName</ref>\n<references group=\"theGroup3\" />mikkul\n",
        "selser [4,2,0,0,0,4,0]": "k6rbr\n\n1l7vu1\n<references group=\"theGroup3\" />emk1c5",
        "selser [[4,0,3,0,0,0,4,0,4,0,0,0,0,0],0,0,0,0,4,0]": "16r1mvu<ref group=\"theGroup\" name=\"theName\">theValue</ref><ref group=\"theGroup3\" name=\"theName3\">theValue3</ref>\nGROUP2 <ref group=\"theGroup2\" name=\"theName2\">theValue2</ref>nxohyj<ref group=\"theGroup3\" name=\"theName\">anotherValue3differentName</ref>vq18di<ref group=\"theGroup2\" name=\"anotherName2\">anotherValue2DifferentName</ref>\nanotherGROUP3 <ref group=\"theGroup3\" name=\"theName3\">anotherValue3</ref>\naDifferentNameGROUP <ref group=\"theGroup\" name=\"anotherName2\">anotherValueDifferentName</ref>\n<references group=\"theGroup3\" />125ihu5"
    },
    "Hoisting multiple references should keep references in order": {
        "selser [0,2,0]": "[[Foo|hello <ref>note 1</ref><ref>note 2</ref>]]<ref>note 3</ref>\n\nskll29\n<references />",
        "selser [2,3,0]": "ehf66i\n\n[[Foo|hello <ref>note 1</ref><ref>note 2</ref>]]<ref>note 3</ref><references />",
        "selser [[1,0,0,0],0,0]": "[[Foo|hello]] <ref>note 3</ref>\n<references />",
        "selser [[[3],0,0,0],0,0]": "<ref>note 3</ref>\n<references />",
        "selser [1,2,0]": "[[Foo|hello <ref>note 1</ref><ref>note 2</ref>]]<ref>note 3</ref>\n\n1pnv3hs\n<references />",
        "selser [1,0,0]": "[[Foo|hello <ref>note 1</ref><ref>note 2</ref>]]<ref>note 3</ref>\n<references />",
        "selser [2,2,0]": "1yhdskf\n\n[[Foo|hello <ref>note 1</ref><ref>note 2</ref>]]<ref>note 3</ref>\n\n1px7rgk\n<references />",
        "selser [[[4],0,0,0],3,0]": "[[Foo|157cn7a]]<ref>note 3</ref><references />",
        "selser [2,0,0]": "w5ildv\n\n[[Foo|hello <ref>note 1</ref><ref>note 2</ref>]]<ref>note 3</ref>\n<references />",
        "selser [[4,0,0,0],2,0]": "lyepzj<ref>note 3</ref>\n\n1yfhy9s\n<references />",
        "selser [[2,0,0,0],0,0]": "u6ocmx[[Foo|hello <ref>note 1</ref><ref>note 2</ref>]]<ref>note 3</ref>\n<references />",
        "selser [0,3,0]": "[[Foo|hello <ref>note 1</ref><ref>note 2</ref>]]<ref>note 3</ref><references />",
        "selser [1,3,0]": "[[Foo|hello <ref>note 1</ref><ref>note 2</ref>]]<ref>note 3</ref><references />",
        "selser [[4,0,0,0],0,0]": "ycfpmk<ref>note 3</ref>\n<references />",
        "selser [2,4,0]": "kpn8qp\n\n[[Foo|hello <ref>note 1</ref><ref>note 2</ref>]]<ref>note 3</ref>\n\n1wtlfei<references />"
    },
    "Multiple definition (inside {{#tag:references}})": {
        "wt2html": "<p data-parsoid='{\"dsr\":[0,86,0,0]}'><sup about=\"#mwt2\" class=\"mw-ref reference\" id=\"cite_ref-a_1-0\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"dsr\":[0,16,16,0]}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"a\"}}'><a href=\"./Parser_test#cite_note-a-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup>\n<references about=\"#mwt5\" typeof=\"mw:Transclusion\" data-parsoid='{\"dsr\":[17,86,null,null],\"pi\":[[{\"k\":\"1\"}]]}' data-mw='{\"parts\":[{\"template\":{\"target\":{\"wt\":\"#tag:references\",\"function\":\"tag\"},\"params\":{\"1\":{\"wt\":\"\\n&lt;ref name=\\\"a\\\">abc&lt;/ref>\\n&lt;ref name=\\\"a\\\">def&lt;/ref>\\n\"}},\"i\":0}}]}'>\n<sup about=\"#mwt6\" class=\"mw-ref reference\" id=\"cite_ref-a_1-1\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"src\":\"&lt;ref name=\\\"a\\\">abc&lt;/ref>\"}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"a\"},\"body\":{\"id\":\"mw-reference-text-cite_note-a-1\"}}'><a href=\"./Parser_test#cite_note-a-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup>\n<sup about=\"#mwt7\" class=\"mw-ref reference\" id=\"cite_ref-a_1-2\" rel=\"dc:references\" typeof=\"mw:Extension/ref mw:Error\" data-parsoid='{\"src\":\"&lt;ref name=\\\"a\\\">def&lt;/ref>\"}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"a\"},\"body\":{\"html\":\"def\"},\"errors\":[{\"key\":\"cite_error_references_duplicate_key\",\"params\":[\"a\"]}]}'><a href=\"./Parser_test#cite_note-a-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup>\n</references></p>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt9\" data-parsoid='{\"dsr\":[87,101,14,0]}' data-mw='{\"name\":\"references\",\"attrs\":{}}'><ol class=\"mw-references references\" data-parsoid=\"{}\"><li about=\"#cite_note-a-1\" id=\"cite_note-a-1\" data-parsoid=\"{}\"><span rel=\"mw:referencedBy\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-a_1-0\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">1 </span></a><a href=\"./Parser_test#cite_ref-a_1-1\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">2 </span></a><a href=\"./Parser_test#cite_ref-a_1-2\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">3 </span></a></span> <span id=\"mw-reference-text-cite_note-a-1\" class=\"mw-reference-text\" data-parsoid=\"{}\">abc</span></li></ol></div>",
        "html2html": "<p data-parsoid='{\"dsr\":[0,71,0,0]}'><sup id=\"cite_ref-a_1-0\" class=\"reference\" data-parsoid='{\"stx\":\"html\",\"dsr\":[0,71,43,6]}'><a rel=\"mw:WikiLink\" href=\"./Parser_test#cite_note-a-1\" data-parsoid='{\"stx\":\"piped\",\"a\":{\"href\":\"./Parser_test#cite_note-a-1\"},\"sa\":{\"href\":\"#cite_note-a-1\"},\"dsr\":[43,65,17,2]}'>[1]</a></sup></p>\n\n<div class=\"mw-references-wrap\" data-parsoid='{\"stx\":\"html\",\"dsr\":[73,398,32,6]}'>\n<ol data-parsoid='{\"dsr\":[106,390,0,0]}'><li data-parsoid='{\"dsr\":[106,390,1,0,1,0]}'><span class=\"mw-cite-backlink\" data-parsoid='{\"stx\":\"html\",\"dsr\":[108,169,31,7]}'><a rel=\"mw:WikiLink\" href=\"./Parser_test#cite_ref-a_1-0\" data-parsoid='{\"stx\":\"piped\",\"a\":{\"href\":\"./Parser_test#cite_ref-a_1-0\"},\"sa\":{\"href\":\"#cite_ref-a_1-0\"},\"dsr\":[139,162,18,2]}'>↑</a></span> <span class=\"reference-text\" data-parsoid='{\"stx\":\"html\",\"dsr\":[170,390,29,7]}'>abc <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\" data-parsoid='{\"stx\":\"html\",\"dsr\":[203,383,58,7]}'>Cite error: Invalid <code data-parsoid='{\"stx\":\"html\",\"dsr\":[281,316,6,7]}'><span typeof=\"mw:Nowiki\" data-parsoid='{\"dsr\":[287,309,8,9]}'>&lt;ref></span></code> tag; name \"a\" defined multiple times with different content</span></span></li></ol>\n\n</div>",
        "html2wt": "<sup id=\"cite_ref-a_1-0\" class=\"reference\">[[#cite_note-a-1|[1]]]</sup>\n\n<div class=\"mw-references-wrap\">\n# <span class=\"mw-cite-backlink\">[[#cite_ref-a_1-0|↑]]</span> <span class=\"reference-text\">abc <span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code><nowiki><ref></nowiki></code> tag; name \"a\" defined multiple times with different content</span></span>\n\n</div>"
    },
    "Numbers in the default group need to start with 1, independent from other groups": {
        "wt2html": "<p data-parsoid='{\"dsr\":[0,100,0,0]}'><sup about=\"#mwt2\" class=\"mw-ref reference\" id=\"cite_ref-a_1-0\" rel=\"dc:references\" typeof=\"mw:Extension/ref mw:Error\" data-parsoid='{\"dsr\":[0,26,26,0]}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"a\",\"group\":\"g\"},\"errors\":[{\"key\":\"cite_error_group_refs_without_references\",\"params\":[\"g\"]},{\"key\":\"cite_error_references_no_text\"}]}'><a href=\"./Parser_test#cite_note-a-1\" style=\"counter-reset: mw-Ref 1;\" data-mw-group=\"g\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[g 1]</span></a></sup>\n<references about=\"#mwt4\" typeof=\"mw:Transclusion\" data-parsoid='{\"a\":{\"group\":null},\"sa\":{\"group\":\"g\"},\"dsr\":[27,78,null,null],\"pi\":[[{\"k\":\"1\"},{\"k\":\"group\",\"named\":true}]]}' data-mw='{\"parts\":[{\"template\":{\"target\":{\"wt\":\"#tag:references\",\"function\":\"tag\"},\"params\":{\"1\":{\"wt\":\"\\n&lt;ref name=\\\"a\\\">a&lt;/ref>\\n\"},\"group\":{\"wt\":\"g\"}},\"i\":0}}]}'>\n<sup about=\"#mwt5\" class=\"mw-ref reference\" id=\"cite_ref-a_2-0\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"src\":\"&lt;ref name=\\\"a\\\">a&lt;/ref>\"}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"a\"},\"body\":{\"id\":\"mw-reference-text-cite_note-a-2\"}}'><a href=\"./Parser_test#cite_note-a-2\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup>\n</references>\n<sup about=\"#mwt7\" class=\"mw-ref reference\" id=\"cite_ref-c_3-0\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"dsr\":[79,100,14,6]}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"c\"},\"body\":{\"id\":\"mw-reference-text-cite_note-c-3\"}}'><a href=\"./Parser_test#cite_note-c-3\" style=\"counter-reset: mw-Ref 2;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[2]</span></a></sup></p>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt8\" data-parsoid='{\"group\":\"g\",\"dsr\":[100,100,0,0]}' data-mw='{\"name\":\"references\",\"attrs\":{\"group\":\"g\"},\"autoGenerated\":true}'><ol class=\"mw-references references\" data-mw-group=\"g\" data-parsoid=\"{}\"><li about=\"#cite_note-a-1\" id=\"cite_note-a-1\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-a_1-0\" data-mw-group=\"g\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-a-1\" class=\"mw-reference-text\" data-parsoid=\"{}\"></span></li></ol></div>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt9\" data-parsoid='{\"dsr\":[100,100,0,0]}' data-mw='{\"name\":\"references\",\"attrs\":{},\"autoGenerated\":true}'><ol class=\"mw-references references\" data-parsoid=\"{}\"><li about=\"#cite_note-a-2\" id=\"cite_note-a-2\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-a_2-0\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-a-2\" class=\"mw-reference-text\" data-parsoid=\"{}\">a</span></li><li about=\"#cite_note-c-3\" id=\"cite_note-c-3\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-c_3-0\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-c-3\" class=\"mw-reference-text\" data-parsoid=\"{}\">c</span></li></ol></div>",
        "wt2wt": "<ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref name=\"c\">c</ref>\n\n<references />",
        "html2html": "<p data-parsoid='{\"dsr\":[0,98,0,0]}'><sup about=\"#mwt3\" class=\"mw-ref reference\" id=\"cite_ref-a_1-0\" rel=\"dc:references\" typeof=\"mw:Extension/ref mw:Error\" data-parsoid='{\"dsr\":[0,26,26,0]}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"a\",\"group\":\"g\"},\"errors\":[{\"key\":\"cite_error_group_refs_without_references\",\"params\":[\"g\"]},{\"key\":\"cite_error_references_no_text\"}]}'><a href=\"./Parser_test#cite_note-a-1\" style=\"counter-reset: mw-Ref 1;\" data-mw-group=\"g\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[g 1]</span></a></sup>\n<references about=\"#mwt5\" typeof=\"mw:Transclusion\" data-parsoid='{\"a\":{\"group\":null},\"sa\":{\"group\":\"g\"},\"dsr\":[27,76,null,null],\"pi\":[[{\"k\":\"1\"},{\"k\":\"group\",\"named\":true}]]}' data-mw='{\"parts\":[{\"template\":{\"target\":{\"wt\":\"#tag:references\",\"function\":\"tag\"},\"params\":{\"1\":{\"wt\":\"&lt;ref name=\\\"a\\\">a&lt;/ref>\"},\"group\":{\"wt\":\"g\"}},\"i\":0}}]}'><sup about=\"#mwt6\" class=\"mw-ref reference\" id=\"cite_ref-a_2-0\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"src\":\"&lt;ref name=\\\"a\\\">a&lt;/ref>\"}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"a\"},\"body\":{\"id\":\"mw-reference-text-cite_note-a-2\"}}'><a href=\"./Parser_test#cite_note-a-2\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup></references>\n<sup about=\"#mwt8\" class=\"mw-ref reference\" id=\"cite_ref-c_3-0\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"dsr\":[77,98,14,6]}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"c\"},\"body\":{\"id\":\"mw-reference-text-cite_note-c-3\"}}'><a href=\"./Parser_test#cite_note-c-3\" style=\"counter-reset: mw-Ref 2;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[2]</span></a></sup></p>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt10\" data-parsoid='{\"dsr\":[99,113,14,0]}' data-mw='{\"name\":\"references\",\"attrs\":{}}'><ol class=\"mw-references references\" data-parsoid=\"{}\"><li about=\"#cite_note-a-2\" id=\"cite_note-a-2\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-a_2-0\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-a-2\" class=\"mw-reference-text\" data-parsoid=\"{}\">a</span></li><li about=\"#cite_note-c-3\" id=\"cite_note-c-3\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-c_3-0\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-c-3\" class=\"mw-reference-text\" data-parsoid=\"{}\">c</span></li></ol></div>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt11\" data-parsoid='{\"group\":\"g\",\"dsr\":[113,113,0,0]}' data-mw='{\"name\":\"references\",\"attrs\":{\"group\":\"g\"},\"autoGenerated\":true}'><ol class=\"mw-references references\" data-mw-group=\"g\" data-parsoid=\"{}\"><li about=\"#cite_note-a-1\" id=\"cite_note-a-1\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-a_1-0\" data-mw-group=\"g\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-a-1\" class=\"mw-reference-text\" data-parsoid=\"{}\"></span></li></ol></div>",
        "html2wt": "<ref name=\"a\" group=\"g\" />\n{{#tag:references|<ref name=\"a\">a</ref>|group=g}}\n<ref name=\"c\">c</ref>\n<references />",
        "selser [3,0,0,3,0]": "\n",
        "selser [3,0,0,2,0]": "\n12udjjv\n",
        "selser [2,3,0,2,0]": "10j4r7m\n\n<ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref name=\"c\">c</ref>v7z3he\n",
        "selser [[0,2,0,0,0],0,0,2,0]": "<ref name=\"a\" group=\"g\" />1734riw\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref name=\"c\">c</ref>\nhw3hl7\n",
        "selser [[0,4,0,0,0],4,0,0,0]": "<ref name=\"a\" group=\"g\" />1waykkx{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref name=\"c\">c</ref>\n\n21c2ph",
        "selser [1,2,0,0,0]": "<ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref name=\"c\">c</ref>\n\naygrvj\n",
        "selser [1,3,0,0,0]": "<ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref name=\"c\">c</ref>",
        "selser [[0,3,0,0,0],3,0,3,0]": "<ref name=\"a\" group=\"g\" />{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref name=\"c\">c</ref>",
        "selser [4,3,0,4,0]": "xis99ig94uzc",
        "selser [[0,2,0,0,0],3,0,0,0]": "<ref name=\"a\" group=\"g\" />dzfiwb\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref name=\"c\">c</ref>",
        "selser [[0,4,0,0,0],0,0,4,0]": "<ref name=\"a\" group=\"g\" />kbcoqk{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref name=\"c\">c</ref>\nnzm8ec",
        "selser [3,2,0,4,0]": "advidq\nw661bb",
        "selser [4,0,0,0,0]": "hmmstx\n",
        "selser [[0,3,0,3,0],0,0,0,0]": "<ref name=\"a\" group=\"g\" />{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}<ref name=\"c\">c</ref>\n",
        "selser [3,0,0,0,0]": "\n",
        "selser [[0,4,0,2,0],0,0,0,0]": "<ref name=\"a\" group=\"g\" />1jndzf3{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}agzyfh\n<ref name=\"c\">c</ref>\n",
        "selser [[0,0,0,3,0],0,0,0,0]": "<ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}<ref name=\"c\">c</ref>\n",
        "selser [1,3,0,4,0]": "<ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref name=\"c\">c</ref>wj9nby",
        "selser [1,4,0,0,0]": "<ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref name=\"c\">c</ref>\n\n1cy7ynj",
        "selser [3,4,0,0,0]": "xz59a5"
    },
    "Ref in ref: top level ref nested in parser function": {
        "wt2html": "<p data-parsoid='{\"dsr\":[0,35,0,0]}'>test <ref about=\"#mwt2\" typeof=\"mw:Transclusion\" data-parsoid='{\"dsr\":[5,35,null,null],\"pi\":[[{\"k\":\"1\"}]]}' data-mw='{\"parts\":[{\"template\":{\"target\":{\"wt\":\"#tag:ref\",\"function\":\"tag\"},\"params\":{\"1\":{\"wt\":\"456&lt;ref>123&lt;/ref>\"}},\"i\":0}}]}'>456<sup about=\"#mwt3\" class=\"mw-ref reference\" id=\"cite_ref-1\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"src\":\"&lt;ref>123&lt;/ref>\"}' data-mw='{\"name\":\"ref\",\"attrs\":{},\"body\":{\"id\":\"mw-reference-text-cite_note-1\"}}'><a href=\"./Parser_test#cite_note-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup></ref></p>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt5\" data-parsoid='{\"dsr\":[36,50,14,0]}' data-mw='{\"name\":\"references\",\"attrs\":{}}'><ol class=\"mw-references references\" data-parsoid=\"{}\"><li about=\"#cite_note-1\" id=\"cite_note-1\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-1\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-1\" class=\"mw-reference-text\" data-parsoid=\"{}\">123</span></li></ol></div>",
        "html2html": "<p data-parsoid='{\"dsr\":[0,35,0,0]}'>test <ref about=\"#mwt3\" typeof=\"mw:Transclusion\" data-parsoid='{\"dsr\":[5,35,null,null],\"pi\":[[{\"k\":\"1\"}]]}' data-mw='{\"parts\":[{\"template\":{\"target\":{\"wt\":\"#tag:ref\",\"function\":\"tag\"},\"params\":{\"1\":{\"wt\":\"456&lt;ref>123&lt;/ref>\"}},\"i\":0}}]}'>456<sup about=\"#mwt4\" class=\"mw-ref reference\" id=\"cite_ref-1\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"src\":\"&lt;ref>123&lt;/ref>\"}' data-mw='{\"name\":\"ref\",\"attrs\":{},\"body\":{\"id\":\"mw-reference-text-cite_note-1\"}}'><a href=\"./Parser_test#cite_note-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup></ref></p>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt6\" data-parsoid='{\"dsr\":[36,50,14,0]}' data-mw='{\"name\":\"references\",\"attrs\":{}}'><ol class=\"mw-references references\" data-parsoid=\"{}\"><li about=\"#cite_note-1\" id=\"cite_note-1\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-1\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-1\" class=\"mw-reference-text\" data-parsoid=\"{}\">123</span></li></ol></div>"
    },
    "Ref in ref: top level ref nested in transclusion": {
        "wt2html": "<p data-parsoid='{\"dsr\":[0,35,0,0]}'>test <sup about=\"#mwt2\" class=\"mw-ref reference\" id=\"cite_ref-2\" rel=\"dc:references\" typeof=\"mw:Transclusion mw:Extension/ref\" data-parsoid='{\"dsr\":[5,35,null,null],\"pi\":[[{\"k\":\"1\"}]]}' data-mw='{\"parts\":[{\"template\":{\"target\":{\"wt\":\"refinref\",\"href\":\"./Template:Refinref\"},\"params\":{\"1\":{\"wt\":\"456&lt;ref>123&lt;/ref>\"}},\"i\":0}}]}'><a href=\"./Parser_test#cite_note-2\" style=\"counter-reset: mw-Ref 2;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[2]</span></a></sup></p>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt7\" data-parsoid='{\"dsr\":[36,50,14,0]}' data-mw='{\"name\":\"references\",\"attrs\":{}}'><ol class=\"mw-references references\" data-parsoid=\"{}\"><li about=\"#cite_note-1\" id=\"cite_note-1\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-1\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-1\" class=\"mw-reference-text\" data-parsoid=\"{}\">123</span></li><li about=\"#cite_note-2\" id=\"cite_note-2\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-2\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-2\" class=\"mw-reference-text\" data-parsoid=\"{}\">456<sup about=\"#mwt3\" class=\"mw-ref reference\" id=\"cite_ref-1\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"src\":\"&lt;ref>123&lt;/ref>\"}' data-mw='{\"name\":\"ref\",\"attrs\":{},\"body\":{\"id\":\"mw-reference-text-cite_note-1\"}}'><a href=\"./Parser_test#cite_note-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup></span></li></ol></div>",
        "html2html": "<p data-parsoid='{\"dsr\":[0,35,0,0]}'>test <sup about=\"#mwt3\" class=\"mw-ref reference\" id=\"cite_ref-2\" rel=\"dc:references\" typeof=\"mw:Transclusion mw:Extension/ref\" data-parsoid='{\"dsr\":[5,35,null,null],\"pi\":[[{\"k\":\"1\"}]]}' data-mw='{\"parts\":[{\"template\":{\"target\":{\"wt\":\"refinref\",\"href\":\"./Template:Refinref\"},\"params\":{\"1\":{\"wt\":\"456&lt;ref>123&lt;/ref>\"}},\"i\":0}}]}'><a href=\"./Parser_test#cite_note-2\" style=\"counter-reset: mw-Ref 2;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[2]</span></a></sup></p>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt8\" data-parsoid='{\"dsr\":[36,50,14,0]}' data-mw='{\"name\":\"references\",\"attrs\":{}}'><ol class=\"mw-references references\" data-parsoid=\"{}\"><li about=\"#cite_note-1\" id=\"cite_note-1\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-1\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-1\" class=\"mw-reference-text\" data-parsoid=\"{}\">123</span></li><li about=\"#cite_note-2\" id=\"cite_note-2\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-2\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-2\" class=\"mw-reference-text\" data-parsoid=\"{}\">456<sup about=\"#mwt4\" class=\"mw-ref reference\" id=\"cite_ref-1\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"src\":\"&lt;ref>123&lt;/ref>\"}' data-mw='{\"name\":\"ref\",\"attrs\":{},\"body\":{\"id\":\"mw-reference-text-cite_note-1\"}}'><a href=\"./Parser_test#cite_note-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup></span></li></ol></div>"
    },
    "Ref: 12. ref-tags act as trailing newline migration barrier": {
        "selser [4,[2],3,2,4,[4],3,0]": "7i6vwo\n\nfzf7t0a\n\n1cltg43\n\nb<!--the newline at the end of this line stays inside the p tag--> <ref>foo</ref>\n<ref>bar</ref>\n\n7vjkpr\n\n1vn32lo\n<references />"
    },
    "Ref: 3. spaces in ref-names should be ignored": {
        "wt2wt": "A <ref name=\"x\">foo</ref>\nB <ref name=\"x\" />\nC <ref name=\"x\" />\n<references />",
        "html2wt": "A <ref name=\"x\">foo</ref>\nB <ref name=\"x\" />\nC <ref name=\"x\" />\n<references />",
        "selser [[0,0,2,0,3,0],0,0]": "A <ref name=\"x\">foo</ref>bgo09a\nB <ref name=\" x \" /><ref name= x  />\n<references />",
        "selser [[0,0,4,0,2,0],0,0]": "A <ref name=\"x\">foo</ref>zn8msh<ref name=\" x \" />c5u3nz\nC <ref name= x  />\n<references />",
        "selser [[0,0,3,0,0,0],3,0]": "A <ref name=\"x\">foo</ref><ref name=\" x \" />\nC <ref name= x  /><references />",
        "selser [[4,0,3,0,3,0],0,0]": "u3w7pb<ref name=\"x\">foo</ref><ref name=\" x \" /><ref name= x  />\n<references />",
        "selser [2,0,0]": "1jut7m6\n\nA <ref name=\"x\">foo</ref>\nB <ref name=\" x \" />\nC <ref name= x  />\n<references />",
        "selser [[3,0,4,0,0,0],4,0]": "<ref name=\"x\">foo</ref>1c9mhyo<ref name=\" x \" />\nC <ref name= x  />\n\n1f5a5xx<references />",
        "selser [1,2,0]": "A <ref name=\"x\">foo</ref>\nB <ref name=\" x \" />\nC <ref name= x  />\n\n1d4omiq\n<references />",
        "selser [0,4,0]": "A <ref name=\"x\">foo</ref>\nB <ref name=\" x \" />\nC <ref name= x  />\n\n8n56tv<references />",
        "selser [[4,0,2,0,0,0],0,0]": "av0irw<ref name=\"x\">foo</ref>63jwli\nB <ref name=\" x \" />\nC <ref name= x  />\n<references />",
        "selser [[3,0,3,0,0,0],0,0]": "<ref name=\"x\">foo</ref><ref name=\" x \" />\nC <ref name= x  />\n<references />",
        "selser [[0,0,4,0,3,0],4,0]": "A <ref name=\"x\">foo</ref>1dkz2w8<ref name=\" x \" /><ref name= x  />\n\nti4ywv<references />",
        "selser [[4,0,0,0,3,0],2,0]": "cvv2e<ref name=\"x\">foo</ref>\nB <ref name=\" x \" /><ref name= x  />\n\n33wcuy\n<references />",
        "selser [[3,0,3,0,0,0],2,0]": "<ref name=\"x\">foo</ref><ref name=\" x \" />\nC <ref name= x  />\n\nkmsr29\n<references />",
        "selser [1,0,0]": "A <ref name=\"x\">foo</ref>\nB <ref name=\" x \" />\nC <ref name= x  />\n<references />",
        "selser [[3,0,0,0,0,0],3,0]": "<ref name=\"x\">foo</ref>\nB <ref name=\" x \" />\nC <ref name= x  /><references />",
        "selser [[3,0,4,0,2,0],0,0]": "<ref name=\"x\">foo</ref>101p079<ref name=\" x \" />3m6jc7\nC <ref name= x  />\n<references />",
        "selser [[0,0,0,0,4,0],0,0]": "A <ref name=\"x\">foo</ref>\nB <ref name=\" x \" />baab28<ref name= x  />\n<references />"
    },
    "Ref: 8. transclusion wikitext has lower precedence": {
        "wt2wt": "A <ref><nowiki> foo {{1x|</nowiki></ref><nowiki> B C}}</nowiki>\n\n<references />",
        "html2html": "<p data-parsoid='{\"dsr\":[0,63,0,0]}'>A <sup about=\"#mwt4\" class=\"mw-ref reference\" id=\"cite_ref-1\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"dsr\":[2,40,5,6]}' data-mw='{\"name\":\"ref\",\"attrs\":{},\"body\":{\"id\":\"mw-reference-text-cite_note-1\"}}'><a href=\"./Parser_test#cite_note-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup><span typeof=\"mw:Nowiki\" data-parsoid='{\"dsr\":[40,63,8,9]}'> B C}}</span></p>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt6\" data-parsoid='{\"dsr\":[64,78,14,0]}' data-mw='{\"name\":\"references\",\"attrs\":{}}'><ol class=\"mw-references references\" data-parsoid=\"{}\"><li about=\"#cite_note-1\" id=\"cite_note-1\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-1\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-1\" class=\"mw-reference-text\" data-parsoid=\"{}\"> foo {{1x|</span></li></ol></div>",
        "html2wt": "A <ref><nowiki> foo {{1x|</nowiki></ref><nowiki> B C}}</nowiki>\n<references />",
        "selser [[3,0,0],0,0]": "<ref> foo {{1x|</ref> B C}}\n\n<references />",
        "selser [[3,0,0],3,0]": "<ref> foo {{1x|</ref> B C}}<references />",
        "selser [0,2,0]": "A <ref> foo {{1x|</ref> B C}}\n\n232wei\n\n<references />",
        "selser [[0,0,2],2,0]": "A <ref> foo {{1x|</ref><nowiki>lhhaci B C}}</nowiki>\n\n1rk0l3t\n\n<references />",
        "selser [1,4,0]": "A <ref> foo {{1x|</ref> B C}}\n\nu9t9ud<references />",
        "selser [0,3,0]": "A <ref> foo {{1x|</ref> B C}}<references />",
        "selser [[2,0,0],0,0]": "tz66ieA <ref> foo {{1x|</ref> B C}}\n\n<references />",
        "selser [[2,0,4],0,0]": "1spohtmA <ref> foo {{1x|</ref>fdorka\n\n<references />",
        "selser [0,4,0]": "A <ref> foo {{1x|</ref> B C}}\n\n1hy11rc<references />",
        "selser [[4,0,3],4,0]": "1abu1po<ref> foo {{1x|</ref>\n\n1ly2yt3<references />",
        "selser [1,0,0]": "A <ref> foo {{1x|</ref> B C}}\n\n<references />",
        "selser [[3,0,0],2,0]": "<ref> foo {{1x|</ref> B C}}\n\n733hyo\n\n<references />",
        "selser [[4,0,2],3,0]": "kfd1um<ref> foo {{1x|</ref><nowiki>1qghqn9 B C}}</nowiki><references />",
        "selser [2,0,0]": "1g727md\n\nA <ref> foo {{1x|</ref> B C}}\n\n<references />",
        "selser [[2,0,0],2,0]": "1afn0jkA <ref> foo {{1x|</ref> B C}}\n\n11z3b8h\n\n<references />",
        "selser [[0,0,4],4,0]": "A <ref> foo {{1x|</ref>1vutmtj\n\nd3igfs<references />",
        "selser [[4,0,2],4,0]": "196plys<ref> foo {{1x|</ref><nowiki>1jwbmk4 B C}}</nowiki>\n\n1k9iwxo<references />"
    },
    "Ref: 9. unclosed comments should not leak out of ref-body": {
        "wt2wt": "A <ref> foo <!----></ref> B C\n<references />",
        "html2wt": "A <ref> foo <!----></ref> B C\n<references />",
        "selser [2,3,0]": "5vqncy\n\nA <ref> foo <!--</ref> B C<references />",
        "selser [[4,0,0],4,0]": "enxstj<ref> foo <!--</ref> B C\n\nffz473<references />",
        "selser [[0,0,4],3,0]": "A <ref> foo <!--</ref>bkgoyg<references />",
        "selser [[2,0,0],2,0]": "fvipshA <ref> foo <!--</ref> B C\n\n1kr7noz\n<references />",
        "selser [1,0,0]": "A <ref> foo <!--</ref> B C\n<references />",
        "selser [[2,0,0],0,0]": "nme5ogA <ref> foo <!--</ref> B C\n<references />",
        "selser [[3,0,2],0,0]": "<ref> foo <!--</ref>1eg7mz8 B C\n<references />",
        "selser [[4,0,4],2,0]": "h9unkw<ref> foo <!--</ref>nr923z\n\ntcumap\n<references />",
        "selser [[3,0,4],0,0]": "<ref> foo <!--</ref>3e486e\n<references />",
        "selser [1,2,0]": "A <ref> foo <!--</ref> B C\n\nbzoeog\n<references />",
        "selser [[2,0,0],4,0]": "gk7d8eA <ref> foo <!--</ref> B C\n\n18hcbar<references />",
        "selser [[4,0,0],3,0]": "1eumrqx<ref> foo <!--</ref> B C<references />",
        "selser [2,0,0]": "ddvova\n\nA <ref> foo <!--</ref> B C\n<references />",
        "selser [[0,0,2],0,0]": "A <ref> foo <!--</ref>1gt768x B C\n<references />",
        "selser [[3,0,3],4,0]": "<ref> foo <!--</ref>\n\n19u9571<references />",
        "selser [[0,0,4],2,0]": "A <ref> foo <!--</ref>17e7gw7\n\n12k43e1\n<references />"
    },
    "References: 7b. Multiple references tags some with errors should be correctly handled": {
        "selser [[4,0,0,0,0,0,3,0],0,0,0,0,2,3,0,0,4,0,4,[4,0,2,0],4,0,2,1,3,0]": "1j89wn7<ref name=\"foo\" />\nBETA<ref name=\"foo\" />\nONE<ref group=\"NOTES\" name=\"foo\" /><ref group=\"NOTES\" name=\"foo\">food</ref>\n<references group=\"NOTES\" />\n<references />1rwkqso\n\n<references group=\"NOTES\" />1jq071f<references>\n<ref name=\"foo\">NOGROUPCONTENT</ref>\n</references>14oe7ga\n\nbgmxhf<ref group=\"NOTES\" name=\"bar\" />pshdot\nEIGHT<ref group=\"NOTES\" name=\"foo\" />\n\nz8j9mw<references group=\"NOTES\" />hzkodm\nNINE<ref group=\"NOTES\" name=\"bar\">NINECONTENT</ref>\nTEN<ref group=\"NOTES\" name=\"foo\">TENCONTENT</ref>\n<references group=\"NOTES\" />",
        "selser [[3,0,0,0,0,0,0,0],0,0,0,0,0,[4,0,3,0,0,0,2,0],4,0,0,0,4,[4,0,2,0],3,0,0,0,2,0]": "<ref name=\"foo\" />\nBETA<ref name=\"foo\" />\nONE<ref group=\"NOTES\" name=\"foo\" />\nTWO<ref group=\"NOTES\" name=\"foo\">food</ref>\n<references group=\"NOTES\" />\n<references />\n1psrboy<ref group=\"NOTES\" name=\"bar\">CONTENT</ref><ref group=\"NOTES\" name=\"foo\" />\nFIVE<ref group=\"NOTES\" name=\"foo\" />1qszo21\nSIX<ref name=\"foo\" />\n\nsuf1n1<references group=\"NOTES\" />\n<references>\n<ref name=\"foo\">NOGROUPCONTENT</ref>\n</references>25mjc5\n\nyu1kxj<ref group=\"NOTES\" name=\"bar\" />1g10riv\nEIGHT<ref group=\"NOTES\" name=\"foo\" />\n<references group=\"NOTES\" />\nNINE<ref group=\"NOTES\" name=\"bar\">NINECONTENT</ref>\nTEN<ref group=\"NOTES\" name=\"foo\">TENCONTENT</ref>\n\n1d580ro\n<references group=\"NOTES\" />",
        "selser [[0,0,2,0,0,0,3,0],2,0,4,0,3,[3,0,0,0,0,0,2,0],3,0,4,0,2,[0,0,4,0],3,0,3,[3,0,4,0],0,0]": "ALPHA<ref name=\"foo\" />22lt48\nBETA<ref name=\"foo\" />\nONE<ref group=\"NOTES\" name=\"foo\" /><ref group=\"NOTES\" name=\"foo\">food</ref>\n\n1451lew\n<references group=\"NOTES\" />lqoly6<references /><ref group=\"NOTES\" name=\"bar\">CONTENT</ref>\nFOUR<ref group=\"NOTES\" name=\"foo\" />\nFIVE<ref group=\"NOTES\" name=\"foo\" />gre45y\nSIX<ref name=\"foo\" /><references group=\"NOTES\" />10rwhvd<references>\n<ref name=\"foo\">NOGROUPCONTENT</ref>\n</references>1wki71f\nSEVEN<ref group=\"NOTES\" name=\"bar\" />4qwn7w<ref group=\"NOTES\" name=\"foo\" />\n<references group=\"NOTES\" /><ref group=\"NOTES\" name=\"bar\">NINECONTENT</ref>ttkawj<ref group=\"NOTES\" name=\"foo\">TENCONTENT</ref>\n<references group=\"NOTES\" />",
        "selser [[0,0,0,0,3,0,0,0],0,0,2,0,2,[0,0,3,0,0,0,3,0],2,0,0,0,4,3,2,0,2,[4,0,3,0],3,0]": "ALPHA<ref name=\"foo\" />\nBETA<ref name=\"foo\" /><ref group=\"NOTES\" name=\"foo\" />\nTWO<ref group=\"NOTES\" name=\"foo\">food</ref>\n<references group=\"NOTES\" />1qapxjz\n<references />7pf4vl\nTHREE<ref group=\"NOTES\" name=\"bar\">CONTENT</ref><ref group=\"NOTES\" name=\"foo\" />\nFIVE<ref group=\"NOTES\" name=\"foo\" /><ref name=\"foo\" />\n\ndarn3u\n<references group=\"NOTES\" />\n<references>\n<ref name=\"foo\">NOGROUPCONTENT</ref>\n</references>1mumzkf\n\nn7micy\n<references group=\"NOTES\" />j0hkgv\n1itv396<ref group=\"NOTES\" name=\"bar\">NINECONTENT</ref><ref group=\"NOTES\" name=\"foo\">TENCONTENT</ref>\n<references group=\"NOTES\" />"
    },
    "References: 9. Generate missing references list at the end": {
        "wt2wt": "A <ref>foo</ref>\nB <ref group=\"inexistent\">bar</ref>\n<references />\n",
        "html2html": "<p data-parsoid='{\"dsr\":[0,52,0,0]}'>A <sup about=\"#mwt3\" class=\"mw-ref reference\" id=\"cite_ref-1\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"dsr\":[2,16,5,6]}' data-mw='{\"name\":\"ref\",\"attrs\":{},\"body\":{\"id\":\"mw-reference-text-cite_note-1\"}}'><a href=\"./Parser_test#cite_note-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup> B <sup about=\"#mwt4\" class=\"mw-ref reference\" id=\"cite_ref-2\" rel=\"dc:references\" typeof=\"mw:Extension/ref mw:Error\" data-parsoid='{\"dsr\":[19,52,24,6]}' data-mw='{\"name\":\"ref\",\"attrs\":{\"group\":\"inexistent\"},\"body\":{\"id\":\"mw-reference-text-cite_note-2\"},\"errors\":[{\"key\":\"cite_error_group_refs_without_references\",\"params\":[\"inexistent\"]}]}'><a href=\"./Parser_test#cite_note-2\" style=\"counter-reset: mw-Ref 1;\" data-mw-group=\"inexistent\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[inexistent 1]</span></a></sup></p>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt6\" data-parsoid='{\"dsr\":[53,67,14,0]}' data-mw='{\"name\":\"references\",\"attrs\":{}}'><ol class=\"mw-references references\" data-parsoid=\"{}\"><li about=\"#cite_note-1\" id=\"cite_note-1\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-1\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-1\" class=\"mw-reference-text\" data-parsoid=\"{}\">foo</span></li></ol></div>\n\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt7\" data-parsoid='{\"group\":\"inexistent\",\"dsr\":[68,68,0,0]}' data-mw='{\"name\":\"references\",\"attrs\":{\"group\":\"inexistent\"},\"autoGenerated\":true}'><ol class=\"mw-references references\" data-mw-group=\"inexistent\" data-parsoid=\"{}\"><li about=\"#cite_note-2\" id=\"cite_note-2\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-2\" data-mw-group=\"inexistent\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-2\" class=\"mw-reference-text\" data-parsoid=\"{}\">bar</span></li></ol></div>",
        "html2wt": "A <ref>foo</ref> B <ref group=\"inexistent\">bar</ref>\n<references />\n",
        "selser [0,4,0,3,0]": "A <ref>foo</ref>\nB <ref group=\"inexistent\">bar</ref>\n\ng0czw3",
        "selser [4,4,0,4,0]": "whc1pl\n\n1mmf2281nhjc7y",
        "selser [[2,0,2,0],0,0,3,0]": "1cd0gbiA <ref>foo</ref>117zkke\nB <ref group=\"inexistent\">bar</ref>\n",
        "selser [3,0,0,2,0]": "\njqowq3\n",
        "selser [[0,0,2,0],2,0,0,0]": "A <ref>foo</ref>10zxrbq\nB <ref group=\"inexistent\">bar</ref>\n\nuou6bv\n",
        "selser [4,2,0,3,0]": "4w7riv\n\n1rg9j19\n",
        "selser [0,3,0,0,0]": "A <ref>foo</ref>\nB <ref group=\"inexistent\">bar</ref>",
        "selser [[0,0,4,0],0,0,4,0]": "A <ref>foo</ref>dhfezw<ref group=\"inexistent\">bar</ref>\n1vxqzn3",
        "selser [[0,0,4,0],0,0,3,0]": "A <ref>foo</ref>b00lv8<ref group=\"inexistent\">bar</ref>\n",
        "selser [[3,0,0,0],3,0,0,0]": "<ref>foo</ref>\nB <ref group=\"inexistent\">bar</ref>",
        "selser [3,3,0,0,0]": "",
        "selser [[4,0,4,0],2,0,4,0]": "w7dk2y<ref>foo</ref>10mrqy6<ref group=\"inexistent\">bar</ref>\n\n2w18lh\nd4iu9c",
        "selser [4,3,0,2,0]": "o4n0p9yt1njz\n",
        "selser [2,3,0,0,0]": "1wqrh49\n\nA <ref>foo</ref>\nB <ref group=\"inexistent\">bar</ref>",
        "selser [[4,0,0,0],3,0,0,0]": "yo0bpd<ref>foo</ref>\nB <ref group=\"inexistent\">bar</ref>",
        "selser [[4,0,0,0],0,0,2,0]": "14agw3g<ref>foo</ref>\nB <ref group=\"inexistent\">bar</ref>\n1gnz03z\n",
        "selser [1,3,0,0,0]": "A <ref>foo</ref>\nB <ref group=\"inexistent\">bar</ref>",
        "selser [0,0,0,4,0]": "A <ref>foo</ref>\nB <ref group=\"inexistent\">bar</ref>3nzqah",
        "selser [[4,0,0,0],3,0,3,0]": "8kgceb<ref>foo</ref>\nB <ref group=\"inexistent\">bar</ref>",
        "selser [3,0,0,0,0]": "\n"
    },
    "Simple <ref>, with <references/> in group, with groupname in Chinese": {
        "html2wt": "AAA<ref group=\"参\">ref a</ref>BBB<ref group=\"注\">note b</ref>CCC<ref group=\"参\">ref c</ref>\n\n; refs\n<references group=\"参\" />\n\n; notes\n<references group=\"注\" />"
    },
    "T242437 - Blank ref name in #tag regression": {
        "wt2html": "<p data-parsoid='{\"dsr\":[0,44,0,0]}'><references about=\"#mwt2\" typeof=\"mw:Transclusion\" data-parsoid='{\"dsr\":[0,44,null,null],\"pi\":[[{\"k\":\"1\"}]]}' data-mw='{\"parts\":[{\"template\":{\"target\":{\"wt\":\"#tag:references\",\"function\":\"tag\"},\"params\":{\"1\":{\"wt\":\"\\n&lt;ref name=\\\"\\\">foo&lt;/ref>\\n\"}},\"i\":0}}]}'>\n<sup about=\"#mwt3\" class=\"mw-ref reference\" id=\"cite_ref-1\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"src\":\"&lt;ref name=\\\"\\\">foo&lt;/ref>\"}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"\"},\"body\":{\"id\":\"mw-reference-text-cite_note-1\"}}'><a href=\"./Parser_test#cite_note-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup>\n</references></p>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt4\" data-parsoid='{\"dsr\":[44,44,0,0]}' data-mw='{\"name\":\"references\",\"attrs\":{},\"autoGenerated\":true}'><ol class=\"mw-references references\" data-parsoid=\"{}\"><li about=\"#cite_note-1\" id=\"cite_note-1\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-1\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-1\" class=\"mw-reference-text\" data-parsoid=\"{}\">foo</span></li></ol></div>",
        "wt2wt": "{{#tag:references|\n<ref name=\"\">foo</ref>\n}}\n<references />",
        "html2wt": "<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: <code><nowiki><ref></nowiki></code> tag defined in <code><nowiki><references></nowiki></code> has no name attribute.</span>\n",
        "selser [0,2,0]": "{{#tag:references|\n<ref name=\"\">foo</ref>\n}}\n\n6e1uxa\n",
        "selser [2,2,0]": "1frrzfg\n\n{{#tag:references|\n<ref name=\"\">foo</ref>\n}}\n\nyjdbx2\n",
        "selser [3,4,0]": "2ht734",
        "selser [2,0,0]": "1qii04\n\n{{#tag:references|\n<ref name=\"\">foo</ref>\n}}",
        "selser [4,0,0]": "1egl9a6\n",
        "selser [0,4,0]": "{{#tag:references|\n<ref name=\"\">foo</ref>\n}}\n\n1afctgy",
        "selser [3,0,0]": "\n",
        "selser [2,4,0]": "w94t7x\n\n{{#tag:references|\n<ref name=\"\">foo</ref>\n}}\n\nkuazb8",
        "selser [2,3,0]": "10e6xsh\n\n{{#tag:references|\n<ref name=\"\">foo</ref>\n}}",
        "selser [0,3,0]": "{{#tag:references|\n<ref name=\"\">foo</ref>\n}}",
        "selser [1,2,0]": "{{#tag:references|\n<ref name=\"\">foo</ref>\n}}\n\nx8o2nl\n",
        "selser [1,3,0]": "{{#tag:references|\n<ref name=\"\">foo</ref>\n}}",
        "selser [1,0,0]": "{{#tag:references|\n<ref name=\"\">foo</ref>\n}}\n",
        "selser [4,3,0]": "npiwne",
        "selser [4,2,0]": "eq1yls\n\n5b4lhl\n",
        "selser [1,4,0]": "{{#tag:references|\n<ref name=\"\">foo</ref>\n}}\n\n1xxpnr5",
        "selser [4,4,0]": "1e9b7w3\n\n1jbh22t",
        "selser [3,2,0]": "rsqom2\n",
        "selser [3,3,0]": ""
    },
    "T242437 - Nested references edge case, inner tag function with LDR": {
        "wt2wt": "<ref name=\"foo\" />\n\n<references>\n<ref name=\"foo\">bar</ref>\n</references>",
        "html2wt": "<ref name=\"foo\" />\n\n<references>\n<ref name=\"foo\">bar</ref>\n</references>",
        "selser [3,4,0]": "bawpqu<references>\n  {{#tag:references|\n    <ref name=\"foo\">bar</ref>\n  }}\n</references>",
        "selser [3,0,0]": "\n<references>\n  {{#tag:references|\n    <ref name=\"foo\">bar</ref>\n  }}\n</references>",
        "selser [4,0,0]": "ck0llt\n\n<references>\n  {{#tag:references|\n    <ref name=\"foo\">bar</ref>\n  }}\n</references>",
        "selser [1,2,0]": "<ref name=\"foo\" />\n\ncogz2u\n\n<references>\n  {{#tag:references|\n    <ref name=\"foo\">bar</ref>\n  }}\n</references>",
        "selser [0,4,0]": "<ref name=\"foo\" />\n\nh3v8aa<references>\n  {{#tag:references|\n    <ref name=\"foo\">bar</ref>\n  }}\n</references>",
        "selser [0,3,0]": "<ref name=\"foo\" /><references>\n  {{#tag:references|\n    <ref name=\"foo\">bar</ref>\n  }}\n</references>",
        "selser [2,0,0]": "jffeh4\n\n<ref name=\"foo\" />\n\n<references>\n  {{#tag:references|\n    <ref name=\"foo\">bar</ref>\n  }}\n</references>",
        "selser [0,2,0]": "<ref name=\"foo\" />\n\n1tfp11e\n\n<references>\n  {{#tag:references|\n    <ref name=\"foo\">bar</ref>\n  }}\n</references>",
        "selser [3,3,0]": "<references>\n  {{#tag:references|\n    <ref name=\"foo\">bar</ref>\n  }}\n</references>",
        "selser [2,3,0]": "166laqq\n\n<ref name=\"foo\" /><references>\n  {{#tag:references|\n    <ref name=\"foo\">bar</ref>\n  }}\n</references>",
        "selser [1,3,0]": "<ref name=\"foo\" /><references>\n  {{#tag:references|\n    <ref name=\"foo\">bar</ref>\n  }}\n</references>",
        "selser [1,0,0]": "<ref name=\"foo\" />\n\n<references>\n  {{#tag:references|\n    <ref name=\"foo\">bar</ref>\n  }}\n</references>",
        "selser [2,2,0]": "1h8bapc\n\n<ref name=\"foo\" />\n\nt9r6y7\n\n<references>\n  {{#tag:references|\n    <ref name=\"foo\">bar</ref>\n  }}\n</references>",
        "selser [2,4,0]": "q2syc4\n\n<ref name=\"foo\" />\n\nx52kyz<references>\n  {{#tag:references|\n    <ref name=\"foo\">bar</ref>\n  }}\n</references>",
        "selser [4,3,0]": "n4b1sc<references>\n  {{#tag:references|\n    <ref name=\"foo\">bar</ref>\n  }}\n</references>",
        "selser [4,2,0]": "88268g\n\n1u6javj\n\n<references>\n  {{#tag:references|\n    <ref name=\"foo\">bar</ref>\n  }}\n</references>",
        "selser [1,4,0]": "<ref name=\"foo\" />\n\n1r3ee5r<references>\n  {{#tag:references|\n    <ref name=\"foo\">bar</ref>\n  }}\n</references>",
        "selser [3,2,0]": "1h3zbhu\n\n<references>\n  {{#tag:references|\n    <ref name=\"foo\">bar</ref>\n  }}\n</references>",
        "selser [4,4,0]": "1w3p74w\n\n164bamw<references>\n  {{#tag:references|\n    <ref name=\"foo\">bar</ref>\n  }}\n</references>"
    },
    "T242437 - Nested references edge case, outer tag function with LDR": {
        "wt2html": "<p about=\"#mwt5\" typeof=\"mw:Transclusion\" data-parsoid='{\"dsr\":[0,86,0,0],\"firstWikitextNode\":\"P\",\"pi\":[[{\"k\":\"1\"}]]}' data-mw='{\"parts\":[\"&lt;ref name=\\\"foo\\\" />\\n\",{\"template\":{\"target\":{\"wt\":\"#tag:references\",\"function\":\"tag\"},\"params\":{\"1\":{\"wt\":\"\\n  &lt;ref name=\\\"foo\\\">bar&lt;/ref>\\n\\n  &lt;references />\\n\"}},\"i\":0}}]}'><sup about=\"#mwt2\" class=\"mw-ref reference\" id=\"cite_ref-foo_1-0\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"dsr\":[0,18,18,0]}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"foo\"}}'><a href=\"./Parser_test#cite_note-foo-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup>\n<references></references></p><span about=\"#mwt5\">\n</span><pre about=\"#mwt5\"> <sup about=\"#mwt6\" class=\"mw-ref reference\" id=\"cite_ref-foo_1-1\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"src\":\"&lt;ref name=\\\"foo\\\">bar&lt;/ref>\"}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"foo\"},\"body\":{\"id\":\"mw-reference-text-cite_note-foo-1\"}}'><a href=\"./Parser_test#cite_note-foo-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup></pre><span about=\"#mwt5\">\n\n  </span><div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt5\" data-parsoid='{\"src\":\"&lt;references />\"}' data-mw='{\"name\":\"references\",\"attrs\":{}}'><ol class=\"mw-references references\" data-parsoid=\"{}\"><li about=\"#cite_note-foo-1\" id=\"cite_note-foo-1\" data-parsoid=\"{}\"><span rel=\"mw:referencedBy\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-foo_1-0\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">1 </span></a><a href=\"./Parser_test#cite_ref-foo_1-1\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">2 </span></a></span> <span id=\"mw-reference-text-cite_note-foo-1\" class=\"mw-reference-text\" data-parsoid=\"{}\">bar</span></li></ol></div><span about=\"#mwt5\">\n</span><p class=\"mw-empty-elt\" data-parsoid='{\"dsr\":[86,86,0,0]}'></p>",
        "html2html": "<p data-parsoid='{\"dsr\":[0,219,0,0]}'><sup id=\"cite_ref-foo_1-0\" class=\"reference\" data-parsoid='{\"stx\":\"html\",\"dsr\":[0,75,45,6]}'><a rel=\"mw:WikiLink\" href=\"./Parser_test#cite_note-foo-1\" data-parsoid='{\"stx\":\"piped\",\"a\":{\"href\":\"./Parser_test#cite_note-foo-1\"},\"sa\":{\"href\":\"#cite_note-foo-1\"},\"dsr\":[45,69,19,2]}'>[1]</a></sup>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\" data-parsoid='{\"stx\":\"html\",\"dsr\":[76,219,58,7]}'>Cite error: Closing tag missing for <code data-parsoid='{\"stx\":\"html\",\"dsr\":[170,212,6,7]}'><span typeof=\"mw:Nowiki\" data-parsoid='{\"dsr\":[176,205,8,9]}'>&lt;references></span></code></span></p>\n",
        "html2wt": "<sup id=\"cite_ref-foo_1-0\" class=\"reference\">[[#cite_note-foo-1|[1]]]</sup>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Closing tag missing for <code><nowiki><references></nowiki></code></span>\n"
    },
    "T242437 - Nested references edge case, outer tag function, inner LDR": {
        "wt2html": "<p about=\"#mwt4\" typeof=\"mw:Transclusion\" data-parsoid='{\"dsr\":[0,101,0,0],\"firstWikitextNode\":\"P\",\"pi\":[[{\"k\":\"1\"}]]}' data-mw='{\"parts\":[\"&lt;ref name=\\\"foo\\\" />\\n\",{\"template\":{\"target\":{\"wt\":\"#tag:references\",\"function\":\"tag\"},\"params\":{\"1\":{\"wt\":\"\\n  &lt;references>\\n    &lt;ref name=\\\"foo\\\">bar&lt;/ref>\\n  &lt;/references>\\n\"}},\"i\":0}}]}'><sup about=\"#mwt2\" class=\"mw-ref reference\" id=\"cite_ref-foo_1-0\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"dsr\":[0,18,18,0]}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"foo\"}}'><a href=\"./Parser_test#cite_note-foo-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup>\n<references></references></p><span about=\"#mwt4\">\n  </span><div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt4\" data-parsoid='{\"src\":\"&lt;references>\\n    &lt;ref name=\\\"foo\\\">bar&lt;/ref>\\n  &lt;/references>\"}' data-mw='{\"name\":\"references\",\"attrs\":{},\"body\":{\"html\":\"\\n&lt;sup about=\\\"#mwt6\\\" class=\\\"mw-ref reference\\\" rel=\\\"dc:references\\\" typeof=\\\"mw:Extension/ref\\\" data-parsoid=\\\"{}\\\" data-mw=&apos;{\\\"name\\\":\\\"ref\\\",\\\"attrs\\\":{\\\"name\\\":\\\"foo\\\"},\\\"body\\\":{\\\"id\\\":\\\"mw-reference-text-cite_note-foo-1\\\"}}&apos;>&lt;a href=\\\"./Parser_test#cite_note-foo-1\\\" style=\\\"counter-reset: mw-Ref 1;\\\" data-parsoid=\\\"{}\\\">&lt;span class=\\\"mw-reflink-text\\\" data-parsoid=\\\"{}\\\">[1]&lt;/span>&lt;/a>&lt;/sup>\\n\"}}'><ol class=\"mw-references references\" data-parsoid=\"{}\"><li about=\"#cite_note-foo-1\" id=\"cite_note-foo-1\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-foo_1-0\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-foo-1\" class=\"mw-reference-text\" data-parsoid=\"{}\">bar</span></li></ol></div><span about=\"#mwt4\">\n</span><p class=\"mw-empty-elt\" data-parsoid='{\"dsr\":[101,101,0,0]}'></p>",
        "html2html": "<p data-parsoid='{\"dsr\":[0,219,0,0]}'><sup id=\"cite_ref-foo_1-0\" class=\"reference\" data-parsoid='{\"stx\":\"html\",\"dsr\":[0,75,45,6]}'><a rel=\"mw:WikiLink\" href=\"./Parser_test#cite_note-foo-1\" data-parsoid='{\"stx\":\"piped\",\"a\":{\"href\":\"./Parser_test#cite_note-foo-1\"},\"sa\":{\"href\":\"#cite_note-foo-1\"},\"dsr\":[45,69,19,2]}'>[1]</a></sup>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\" data-parsoid='{\"stx\":\"html\",\"dsr\":[76,219,58,7]}'>Cite error: Closing tag missing for <code data-parsoid='{\"stx\":\"html\",\"dsr\":[170,212,6,7]}'><span typeof=\"mw:Nowiki\" data-parsoid='{\"dsr\":[176,205,8,9]}'>&lt;references></span></code></span></p>\n",
        "html2wt": "<sup id=\"cite_ref-foo_1-0\" class=\"reference\">[[#cite_note-foo-1|[1]]]</sup>\n<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Closing tag missing for <code><nowiki><references></nowiki></code></span>\n"
    },
    "T48140 - Make sure rollback/redo does not consume numbers": {
        "wt2html": "<p data-parsoid='{\"dsr\":[0,128,0,0]}'><sup about=\"#mwt2\" class=\"mw-ref reference\" id=\"cite_ref-1\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"dsr\":[0,24,5,6]}' data-mw='{\"name\":\"ref\",\"attrs\":{},\"body\":{\"id\":\"mw-reference-text-cite_note-1\"}}'><a href=\"./Parser_test#cite_note-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup>\n<sup about=\"#mwt4\" class=\"mw-ref reference\" id=\"cite_ref-a_2-0\" rel=\"dc:references\" typeof=\"mw:Extension/ref mw:Error\" data-parsoid='{\"dsr\":[25,51,26,0]}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"a\",\"group\":\"g\"},\"errors\":[{\"key\":\"cite_error_group_refs_without_references\",\"params\":[\"g\"]},{\"key\":\"cite_error_references_no_text\"}]}'><a href=\"./Parser_test#cite_note-a-2\" style=\"counter-reset: mw-Ref 1;\" data-mw-group=\"g\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[g 1]</span></a></sup>\n<references about=\"#mwt6\" typeof=\"mw:Transclusion\" data-parsoid='{\"a\":{\"group\":null},\"sa\":{\"group\":\"g\"},\"dsr\":[52,103,null,null],\"pi\":[[{\"k\":\"1\"},{\"k\":\"group\",\"named\":true}]]}' data-mw='{\"parts\":[{\"template\":{\"target\":{\"wt\":\"#tag:references\",\"function\":\"tag\"},\"params\":{\"1\":{\"wt\":\"\\n&lt;ref name=\\\"a\\\">a&lt;/ref>\\n\"},\"group\":{\"wt\":\"g\"}},\"i\":0}}]}'>\n<sup about=\"#mwt7\" class=\"mw-ref reference\" id=\"cite_ref-a_3-0\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"src\":\"&lt;ref name=\\\"a\\\">a&lt;/ref>\"}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"a\"},\"body\":{\"id\":\"mw-reference-text-cite_note-a-3\"}}'><a href=\"./Parser_test#cite_note-a-3\" style=\"counter-reset: mw-Ref 2;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[2]</span></a></sup>\n</references>\n<sup about=\"#mwt9\" class=\"mw-ref reference\" id=\"cite_ref-4\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"dsr\":[104,128,5,6]}' data-mw='{\"name\":\"ref\",\"attrs\":{},\"body\":{\"id\":\"mw-reference-text-cite_note-4\"}}'><a href=\"./Parser_test#cite_note-4\" style=\"counter-reset: mw-Ref 3;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[3]</span></a></sup></p>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt10\" data-parsoid='{\"dsr\":[128,128,0,0]}' data-mw='{\"name\":\"references\",\"attrs\":{},\"autoGenerated\":true}'><ol class=\"mw-references references\" data-parsoid=\"{}\"><li about=\"#cite_note-1\" id=\"cite_note-1\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-1\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-1\" class=\"mw-reference-text\" data-parsoid=\"{}\">should be [1]</span></li><li about=\"#cite_note-a-3\" id=\"cite_note-a-3\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-a_3-0\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-a-3\" class=\"mw-reference-text\" data-parsoid=\"{}\">a</span></li><li about=\"#cite_note-4\" id=\"cite_note-4\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-4\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-4\" class=\"mw-reference-text\" data-parsoid=\"{}\">should be [2]</span></li></ol></div>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt11\" data-parsoid='{\"group\":\"g\",\"dsr\":[128,128,0,0]}' data-mw='{\"name\":\"references\",\"attrs\":{\"group\":\"g\"},\"autoGenerated\":true}'><ol class=\"mw-references references\" data-mw-group=\"g\" data-parsoid=\"{}\"><li about=\"#cite_note-a-2\" id=\"cite_note-a-2\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-a_2-0\" data-mw-group=\"g\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-a-2\" class=\"mw-reference-text\" data-parsoid=\"{}\"></span></li></ol></div>",
        "wt2wt": "<ref>should be [1]</ref>\n<ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref>should be [2]</ref>\n<references />\n",
        "html2html": "<p data-parsoid='{\"dsr\":[0,128,0,0]}'><sup about=\"#mwt3\" class=\"mw-ref reference\" id=\"cite_ref-1\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"dsr\":[0,24,5,6]}' data-mw='{\"name\":\"ref\",\"attrs\":{},\"body\":{\"id\":\"mw-reference-text-cite_note-1\"}}'><a href=\"./Parser_test#cite_note-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup>\n<sup about=\"#mwt5\" class=\"mw-ref reference\" id=\"cite_ref-a_2-0\" rel=\"dc:references\" typeof=\"mw:Extension/ref mw:Error\" data-parsoid='{\"dsr\":[25,51,26,0]}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"a\",\"group\":\"g\"},\"errors\":[{\"key\":\"cite_error_group_refs_without_references\",\"params\":[\"g\"]},{\"key\":\"cite_error_references_no_text\"}]}'><a href=\"./Parser_test#cite_note-a-2\" style=\"counter-reset: mw-Ref 1;\" data-mw-group=\"g\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[g 1]</span></a></sup>\n<references about=\"#mwt7\" typeof=\"mw:Transclusion\" data-parsoid='{\"a\":{\"group\":null},\"sa\":{\"group\":\"g\"},\"dsr\":[52,103,null,null],\"pi\":[[{\"k\":\"1\"},{\"k\":\"group\",\"named\":true}]]}' data-mw='{\"parts\":[{\"template\":{\"target\":{\"wt\":\"#tag:references\",\"function\":\"tag\"},\"params\":{\"1\":{\"wt\":\"\\n&lt;ref name=\\\"a\\\">a&lt;/ref>\\n\"},\"group\":{\"wt\":\"g\"}},\"i\":0}}]}'>\n<sup about=\"#mwt8\" class=\"mw-ref reference\" id=\"cite_ref-a_3-0\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"src\":\"&lt;ref name=\\\"a\\\">a&lt;/ref>\"}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"a\"},\"body\":{\"id\":\"mw-reference-text-cite_note-a-3\"}}'><a href=\"./Parser_test#cite_note-a-3\" style=\"counter-reset: mw-Ref 2;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[2]</span></a></sup>\n</references>\n<sup about=\"#mwt10\" class=\"mw-ref reference\" id=\"cite_ref-4\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"dsr\":[104,128,5,6]}' data-mw='{\"name\":\"ref\",\"attrs\":{},\"body\":{\"id\":\"mw-reference-text-cite_note-4\"}}'><a href=\"./Parser_test#cite_note-4\" style=\"counter-reset: mw-Ref 3;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[3]</span></a></sup></p>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt12\" data-parsoid='{\"dsr\":[129,143,14,0]}' data-mw='{\"name\":\"references\",\"attrs\":{}}'><ol class=\"mw-references references\" data-parsoid=\"{}\"><li about=\"#cite_note-1\" id=\"cite_note-1\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-1\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-1\" class=\"mw-reference-text\" data-parsoid=\"{}\">should be [1]</span></li><li about=\"#cite_note-a-3\" id=\"cite_note-a-3\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-a_3-0\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-a-3\" class=\"mw-reference-text\" data-parsoid=\"{}\">a</span></li><li about=\"#cite_note-4\" id=\"cite_note-4\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-4\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-4\" class=\"mw-reference-text\" data-parsoid=\"{}\">should be [2]</span></li></ol></div>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt13\" data-parsoid='{\"group\":\"g\",\"dsr\":[143,143,0,0]}' data-mw='{\"name\":\"references\",\"attrs\":{\"group\":\"g\"},\"autoGenerated\":true}'><ol class=\"mw-references references\" data-mw-group=\"g\" data-parsoid=\"{}\"><li about=\"#cite_note-a-2\" id=\"cite_note-a-2\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-a_2-0\" data-mw-group=\"g\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-a-2\" class=\"mw-reference-text\" data-parsoid=\"{}\"></span></li></ol></div>",
        "html2wt": "<ref>should be [1]</ref>\n<ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref>should be [2]</ref>\n<references />",
        "selser [[0,0,0,4,0,0,0],3,0,0,0]": "<ref>should be [1]</ref>\n<ref name=\"a\" group=\"g\" />1c3x5qc{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref>should be [2]</ref>",
        "selser [[0,0,0,3,0,0,0],0,0,0,0]": "<ref>should be [1]</ref>\n<ref name=\"a\" group=\"g\" />{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref>should be [2]</ref>\n",
        "selser [1,0,0,0,0]": "<ref>should be [1]</ref>\n<ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref>should be [2]</ref>\n",
        "selser [[0,2,0,0,0,3,0],3,0,3,0]": "<ref>should be [1]</ref>1cexmql\n<ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}<ref>should be [2]</ref>",
        "selser [[0,2,0,2,0,0,0],0,0,2,0]": "<ref>should be [1]</ref>1lemqxv\n<ref name=\"a\" group=\"g\" />1o0ykhp\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref>should be [2]</ref>\n1xnrgm2\n",
        "selser [[0,0,0,3,0,0,0],4,0,0,0]": "<ref>should be [1]</ref>\n<ref name=\"a\" group=\"g\" />{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref>should be [2]</ref>\n\n143gp3e",
        "selser [[0,0,0,2,0,4,0],2,0,0,0]": "<ref>should be [1]</ref>\n<ref name=\"a\" group=\"g\" />1sxzevd\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}rig464<ref>should be [2]</ref>\n\nk7ueph\n",
        "selser [[0,4,0,0,0,4,0],4,0,0,0]": "<ref>should be [1]</ref>sf1uiq<ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}p8sl2v<ref>should be [2]</ref>\n\n18c3url",
        "selser [[0,0,0,0,0,3,0],0,0,0,0]": "<ref>should be [1]</ref>\n<ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}<ref>should be [2]</ref>\n",
        "selser [0,4,0,3,0]": "<ref>should be [1]</ref>\n<ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref>should be [2]</ref>\n\n1ea0jgg",
        "selser [[0,3,0,0,0,3,0],0,0,0,0]": "<ref>should be [1]</ref><ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}<ref>should be [2]</ref>\n",
        "selser [4,3,0,4,0]": "1o2zrmk7ep9xm",
        "selser [[0,0,0,2,0,0,0],0,0,4,0]": "<ref>should be [1]</ref>\n<ref name=\"a\" group=\"g\" />1ewykyd\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref>should be [2]</ref>\n28ggtt",
        "selser [[0,2,0,0,0,2,0],4,0,4,0]": "<ref>should be [1]</ref>tdn35q\n<ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}104inmk\n<ref>should be [2]</ref>\n\n14yfn7j1q3hr5v",
        "selser [1,0,0,2,0]": "<ref>should be [1]</ref>\n<ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref>should be [2]</ref>\n1qcginm\n",
        "selser [[0,0,0,0,0,2,0],4,0,4,0]": "<ref>should be [1]</ref>\n<ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}7ipht1\n<ref>should be [2]</ref>\n\n1u1fsvk10bmk94",
        "selser [1,0,0,3,0]": "<ref>should be [1]</ref>\n<ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref>should be [2]</ref>\n",
        "selser [[0,0,0,2,0,4,0],0,0,3,0]": "<ref>should be [1]</ref>\n<ref name=\"a\" group=\"g\" />c02j33\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}r1obp6<ref>should be [2]</ref>\n",
        "selser [[0,3,0,0,0,0,0],4,0,0,0]": "<ref>should be [1]</ref><ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref>should be [2]</ref>\n\nuqy2jy",
        "selser [2,2,0,4,0]": "aypsum\n\n<ref>should be [1]</ref>\n<ref name=\"a\" group=\"g\" />\n{{#tag:references|\n<ref name=\"a\">a</ref>\n|group=g}}\n<ref>should be [2]</ref>\n\n1thipwb\n1rk8y26"
    },
    "Valid parameters become invalid when a third is present": {
        "wt2html": "<p data-parsoid='{\"dsr\":[0,65,0,0]}'><sup about=\"#mwt2\" class=\"mw-ref reference\" id=\"cite_ref-theName_1-0\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"dsr\":[0,65,51,6]}' data-mw='{\"name\":\"ref\",\"attrs\":{\"name\":\"theName\",\"group\":\"theGroup\",\"dummy\":\"dummy\"},\"body\":{\"id\":\"mw-reference-text-cite_note-theName-1\"}}'><a href=\"./Parser_test#cite_note-theName-1\" style=\"counter-reset: mw-Ref 1;\" data-mw-group=\"theGroup\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[theGroup 1]</span></a></sup></p>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt4\" data-parsoid='{\"group\":\"theGroup\",\"dsr\":[66,97,31,0]}' data-mw='{\"name\":\"references\",\"attrs\":{\"group\":\"theGroup\"}}'><ol class=\"mw-references references\" data-mw-group=\"theGroup\" data-parsoid=\"{}\"><li about=\"#cite_note-theName-1\" id=\"cite_note-theName-1\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-theName_1-0\" data-mw-group=\"theGroup\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-theName-1\" class=\"mw-reference-text\" data-parsoid=\"{}\">theValue</span></li></ol></div>",
        "html2wt": "<span class=\"error mw-ext-cite-error\" lang=\"en\" dir=\"ltr\">Cite error: Invalid <code><nowiki><ref></nowiki></code> tag; invalid names, e.g. too many</span>\n"
    },
    "{{REVISIONID}} on page with <ref> (bug 6299)": {
        "wt2html": "<p data-parsoid='{\"dsr\":[0,30,0,0]}'><span about=\"#mwt2\" typeof=\"mw:Transclusion\" data-parsoid='{\"pi\":[[]],\"dsr\":[0,14,null,null]}' data-mw='{\"parts\":[{\"template\":{\"target\":{\"wt\":\"REVISIONID\",\"function\":\"revisionid\"},\"params\":{},\"i\":0}}]}'>Parser function implementation for pf_revisionid missing in Parsoid.</span><sup about=\"#mwt3\" class=\"mw-ref reference\" id=\"cite_ref-1\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"dsr\":[14,30,5,6]}' data-mw='{\"name\":\"ref\",\"attrs\":{},\"body\":{\"id\":\"mw-reference-text-cite_note-1\"}}'><a href=\"./Parser_test#cite_note-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup></p>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt4\" data-parsoid='{\"dsr\":[30,30,0,0]}' data-mw='{\"name\":\"references\",\"attrs\":{},\"autoGenerated\":true}'><ol class=\"mw-references references\" data-parsoid=\"{}\"><li about=\"#cite_note-1\" id=\"cite_note-1\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-1\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-1\" class=\"mw-reference-text\" data-parsoid=\"{}\">elite</span></li></ol></div>",
        "wt2wt": "{{REVISIONID}}<ref>elite</ref>\n<references />",
        "html2html": "<p data-parsoid='{\"dsr\":[0,30,0,0]}'><span about=\"#mwt2\" typeof=\"mw:Transclusion\" data-parsoid='{\"pi\":[[]],\"dsr\":[0,14,null,null]}' data-mw='{\"parts\":[{\"template\":{\"target\":{\"wt\":\"REVISIONID\",\"function\":\"revisionid\"},\"params\":{},\"i\":0}}]}'>Parser function implementation for pf_revisionid missing in Parsoid.</span><sup about=\"#mwt3\" class=\"mw-ref reference\" id=\"cite_ref-1\" rel=\"dc:references\" typeof=\"mw:Extension/ref\" data-parsoid='{\"dsr\":[14,30,5,6]}' data-mw='{\"name\":\"ref\",\"attrs\":{},\"body\":{\"id\":\"mw-reference-text-cite_note-1\"}}'><a href=\"./Parser_test#cite_note-1\" style=\"counter-reset: mw-Ref 1;\" data-parsoid=\"{}\"><span class=\"mw-reflink-text\" data-parsoid=\"{}\">[1]</span></a></sup></p>\n<div class=\"mw-references-wrap\" typeof=\"mw:Extension/references\" about=\"#mwt5\" data-parsoid='{\"dsr\":[31,45,14,0]}' data-mw='{\"name\":\"references\",\"attrs\":{}}'><ol class=\"mw-references references\" data-parsoid=\"{}\"><li about=\"#cite_note-1\" id=\"cite_note-1\" data-parsoid=\"{}\"><a href=\"./Parser_test#cite_ref-1\" rel=\"mw:referencedBy\" data-parsoid=\"{}\"><span class=\"mw-linkback-text\" data-parsoid=\"{}\">↑ </span></a> <span id=\"mw-reference-text-cite_note-1\" class=\"mw-reference-text\" data-parsoid=\"{}\">elite</span></li></ol></div>",
        "html2wt": "{{REVISIONID}}<ref>elite</ref>\n<references />",
        "selser [0,3,0]": "{{REVISIONID}}<ref>elite</ref>",
        "selser [4,0,0]": "gqyiqf\n",
        "selser [1,2,0]": "{{REVISIONID}}<ref>elite</ref>\n\n1a6otiq\n",
        "selser [2,2,0]": "7idxf8\n\n{{REVISIONID}}<ref>elite</ref>\n\n1dburhc\n",
        "selser [3,0,0]": "\n",
        "selser [2,0,0]": "1v8qufh\n\n{{REVISIONID}}<ref>elite</ref>",
        "selser [0,4,0]": "{{REVISIONID}}<ref>elite</ref>\n\nhr3unp",
        "selser [4,3,0]": "1d8jkif",
        "selser [1,4,0]": "{{REVISIONID}}<ref>elite</ref>\n\n1s3icyj",
        "selser [0,2,0]": "{{REVISIONID}}<ref>elite</ref>\n\nrjzpcq\n",
        "selser [1,3,0]": "{{REVISIONID}}<ref>elite</ref>",
        "selser [3,3,0]": "",
        "selser [1,0,0]": "{{REVISIONID}}<ref>elite</ref>\n",
        "selser [3,4,0]": "7uvu41",
        "selser [2,4,0]": "1ndy63i\n\n{{REVISIONID}}<ref>elite</ref>\n\n15wnw26",
        "selser [4,4,0]": "e67fty\n\ns7z72f",
        "selser [4,2,0]": "1kjcdbq\n\n1t30wom\n",
        "selser [2,3,0]": "11e8rkj\n\n{{REVISIONID}}<ref>elite</ref>",
        "selser [3,2,0]": "1ljugez\n"
    },
    "{{REVISIONID}} on page without <ref> (bug 6299 sanity check)": {
        "wt2html": "<p data-parsoid='{\"dsr\":[0,14,0,0]}'><span about=\"#mwt1\" typeof=\"mw:Transclusion\" data-parsoid='{\"pi\":[[]],\"dsr\":[0,14,null,null]}' data-mw='{\"parts\":[{\"template\":{\"target\":{\"wt\":\"REVISIONID\",\"function\":\"revisionid\"},\"params\":{},\"i\":0}}]}'>Parser function implementation for pf_revisionid missing in Parsoid.</span></p>",
        "html2html": "<p data-parsoid='{\"dsr\":[0,14,0,0]}'><span about=\"#mwt1\" typeof=\"mw:Transclusion\" data-parsoid='{\"pi\":[[]],\"dsr\":[0,14,null,null]}' data-mw='{\"parts\":[{\"template\":{\"target\":{\"wt\":\"REVISIONID\",\"function\":\"revisionid\"},\"params\":{},\"i\":0}}]}'>Parser function implementation for pf_revisionid missing in Parsoid.</span></p>"
    }
}
